[gd_scene load_steps=24 format=3 uid="uid://dt0fr1sovy4ny"]

[ext_resource type="Script" uid="uid://c2f6wib7o63aw" path="res://scripts/enemy/boss.gd" id="1_4tpuj"]
[ext_resource type="Script" uid="uid://dfosda1bstp2m" path="res://resources/gameplay/held_pickups.gd" id="2_i5f3v"]
[ext_resource type="Texture2D" uid="uid://cpi4w3fgdon0o" path="res://assets/player/playershadow.png" id="3_cvltp"]
[ext_resource type="Texture2D" uid="uid://xv7338lr5w2" path="res://assets/player/retrodoki_walk.png" id="4_4tpuj"]
[ext_resource type="Texture2D" uid="uid://cx0pgv7haa1th" path="res://assets/explosion/kennynl_pixel_explosion_sheet.png" id="5_kimt4"]
[ext_resource type="Script" uid="uid://dv0vxlhv4rgsm" path="res://scripts/enemy/detection_handlers/detection_handler_type_retro_doki.gd" id="6_4tpuj"]
[ext_resource type="AnimationLibrary" uid="uid://dvi33f4r6k5nh" path="res://animations/enemy.res" id="7_011xw"]
[ext_resource type="Script" uid="uid://bct3b1gr0upgg" path="res://scripts/enemy/enemy_state_machine.gd" id="8_gvudx"]
[ext_resource type="Script" uid="uid://ds673o5kb2vee" path="res://scripts/enemy/wander_types/enemy_wander_path_type.gd" id="9_ox3yh"]
[ext_resource type="Script" uid="uid://ir3sr7r0h3uu" path="res://scripts/enemy/abilities/boss_breakable_ability.gd" id="10_i5f3v"]
[ext_resource type="Script" uid="uid://xpsl7bku1ra4" path="res://scripts/enemy/enemy_state.gd" id="11_6uxst"]
[ext_resource type="Script" uid="uid://ci02bb4ldf005" path="res://scripts/enemy/other_states/enemy_dodge_path_type.gd" id="12_4stnm"]
[ext_resource type="Script" uid="uid://dymov0ubmjnt4" path="res://scripts/enemy/other_states/idle_state.gd" id="13_kowj0"]
[ext_resource type="Script" uid="uid://dmg4ks5be84w7" path="res://scripts/enemy/other_states/enemy_chase_path_type.gd" id="14_smmby"]
[ext_resource type="Texture2D" uid="uid://jog1koyue4lr" path="res://assets/fallingsprite.png" id="15_g1mo1"]

[sub_resource type="Resource" id="Resource_0x7uk"]
resource_local_to_scene = true
script = ExtResource("2_i5f3v")
metadata/_custom_type_script = "uid://dfosda1bstp2m"

[sub_resource type="CircleShape2D" id="CircleShape2D_i1su5"]
radius = 9.0

[sub_resource type="SegmentShape2D" id="SegmentShape2D_4tpuj"]
a = Vector2(0, 16)
b = Vector2(0, 24)

[sub_resource type="Animation" id="Animation_taub5"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_rwxvx"]
_data = {
&"RESET": SubResource("Animation_taub5")
}

[sub_resource type="Animation" id="Animation_0x7uk"]
resource_name = "victory"
length = 1.6
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [0, 16, 11, 18, 0, 16, 11, 18, 0, 16, 11, 18, 0, 16, 11, 18, 0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_irj8q"]
_data = {
&"burry": SubResource("Animation_0x7uk")
}

[sub_resource type="SceneReplicationConfig" id="SceneReplicationConfig_hwcqj"]

[node name="RetroDokiBoss" type="CharacterBody2D" node_paths=PackedStringArray("detection_handler") groups=["thrown_bomb_bounces"]]
texture_filter = 1
collision_layer = 32
collision_mask = 13
script = ExtResource("1_4tpuj")
pickups = SubResource("Resource_0x7uk")
init_bomb_count = 2
movement_speed = 80.0
detection_handler = NodePath("DetectionHandler")
health = 2

[node name="shadowsprite" type="Sprite2D" parent="."]
position = Vector2(0, 8)
scale = Vector2(1, 0.5)
texture = ExtResource("3_cvltp")

[node name="sprite" type="Sprite2D" parent="."]
position = Vector2(0.075, 6.236)
texture = ExtResource("4_4tpuj")
offset = Vector2(-0.075, -8.536)
hframes = 6
vframes = 4

[node name="kaboom" type="Sprite2D" parent="."]
visible = false
position = Vector2(-1.07288e-06, 3.57628e-07)
scale = Vector2(0.333333, 0.351648)
texture = ExtResource("5_kimt4")
hframes = 9

[node name="Hitbox" type="CollisionShape2D" parent="."]
shape = SubResource("CircleShape2D_i1su5")

[node name="FrontArea" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 8

[node name="CollisionShape2D" type="CollisionShape2D" parent="FrontArea"]
shape = SubResource("SegmentShape2D_4tpuj")

[node name="Hurtbox" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 2

[node name="HurtboxShape" type="CollisionShape2D" parent="Hurtbox"]
shape = SubResource("CircleShape2D_i1su5")
disabled = true
debug_color = Color(1, 0, 0, 0.419608)

[node name="DetectionHandler" type="Node2D" parent="."]
script = ExtResource("6_4tpuj")
trigger_chance_bomb = 0.4
trigger_chance_breakable = 0.2

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_rwxvx"),
&"TomatoBoss": SubResource("AnimationLibrary_irj8q"),
&"enemy": ExtResource("7_011xw")
}

[node name="MultiplayerSynchronizer" type="MultiplayerSynchronizer" parent="."]
root_path = NodePath("../StateMachine")
replication_config = SubResource("SceneReplicationConfig_hwcqj")

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("enabled_state", "disabled_state")]
script = ExtResource("8_gvudx")
enabled_state = NodePath("Wander")
disabled_state = NodePath("Disabled")

[node name="Wander" type="Node" parent="StateMachine"]
script = ExtResource("9_ox3yh")

[node name="Ability" type="Node" parent="StateMachine"]
script = ExtResource("10_i5f3v")

[node name="Disabled" type="Node" parent="StateMachine"]
script = ExtResource("11_6uxst")

[node name="Dodge" type="Node" parent="StateMachine"]
script = ExtResource("12_4stnm")

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("13_kowj0")
idle_time = 0.8

[node name="Chase" type="Node" parent="StateMachine"]
script = ExtResource("14_smmby")
chase_stop_distance = 2

[node name="DebugMarker" type="Sprite2D" parent="."]
self_modulate = Color(1, 0, 0, 1)
top_level = true
scale = Vector2(0.1, 0.1)
texture = ExtResource("15_g1mo1")

[node name="DebugMarker2" type="Sprite2D" parent="."]
self_modulate = Color(0, 0, 1, 1)
top_level = true
scale = Vector2(0.1, 0.1)
texture = ExtResource("15_g1mo1")
